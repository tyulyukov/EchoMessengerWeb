import{e as p,u as m,_ as c,d as g,o as a,c as n,a as s,t as f,b as _,w as i,v as l}from"./index.b7986cbb.js";import{u as y,_ as b}from"./echo.f3c9776f.js";const w=p("auth/register",{state:()=>({error:null,loading:!1,internalError:null}),actions:{register(e,r,d){if(this.$reset(),r!==d){this.error="Passwords are not matching";return}const u=m();this.loading=!0,fetch(u.combineUrl("auth/register"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({username:e,password:r})}).then(t=>{if(this.loading=!1,t&&t.status===201)return t.json();if(t&&t.status===400){this.error="Fields must be not empty";return}else if(t&&t.status===403){this.error="Password must contain at least 8 symbols. It must have letters and digits";return}else if(t&&t.status===406){this.error="Username must contain at least 5 symbols and less than 20 symbols. Username must have only latin letters or/and digits. Allowed special symbols: . - _";return}else if(t&&t.status===405){this.error="This username is already busy";return}else if(t&&t.status===500){this.error="Server error";return}}).then(t=>{t&&(console.log("registered"),y().logIn(e,r))}).catch(t=>{this.loading=!1,this.internalError=t,this.error="No connection..."})}}}),S=g({setup(){return{authRegisterStore:w()}},data(){return{username:"",password:"",repeatPassword:""}},methods:{register(){this.authRegisterStore.register(this.username,this.password,this.repeatPassword)}}}),v={class:"center"},R={class:"auth-form"},P=s("img",{class:"logo",src:b},null,-1),$=s("h1",null,"Get Started!",-1),k=s("p",{class:"note"},"Register your account",-1),U={key:0,class:"alert alert-dark"},V={class:"input-group"},A=s("label",null,"Username",-1),C={class:"input-group"},N=s("label",null,"Password",-1),T={class:"input-group"},B=s("label",null,"Repeat Password",-1),E=["disabled"],L={key:2,class:"spinner-border",style:{margin:"1.75rem 0"}},j=s("br",null,null,-1),D=s("a",{href:"/auth"},"Already registered",-1);function I(e,r,d,u,t,h){return a(),n("div",v,[s("div",R,[P,$,k,e.authRegisterStore.$state.error?(a(),n("div",U,f(e.authRegisterStore.$state.error),1)):_("",!0),s("form",null,[s("div",V,[A,i(s("input",{"onUpdate:modelValue":r[0]||(r[0]=o=>e.username=o),id:"username",class:"form-control",type:"text",autocomplete:"false"},null,512),[[l,e.username]])]),s("div",C,[N,i(s("input",{"onUpdate:modelValue":r[1]||(r[1]=o=>e.password=o),id:"password",class:"form-control",type:"password"},null,512),[[l,e.password]])]),s("div",T,[B,i(s("input",{"onUpdate:modelValue":r[2]||(r[2]=o=>e.repeatPassword=o),id:"repeat_password",class:"form-control",type:"password"},null,512),[[l,e.repeatPassword]])])]),e.authRegisterStore.$state.loading?(a(),n("div",L)):(a(),n("button",{key:1,disabled:e.username===""||e.password===""||e.repeatPassword==="",onClick:r[3]||(r[3]=(...o)=>e.register&&e.register(...o)),class:"btn btn-primary btn-submit"},"Register",8,E)),j,D])])}const G=c(S,[["render",I]]);export{G as default};
